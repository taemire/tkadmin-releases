# 대시보드

## 개요

대시보드는 tkadmin의 메인 화면으로, TACHYON 솔루션의 운영 환경 및 설정 상태를 한눈에 확인할 수 있는 통합 모니터링 화면입니다. 접속 시 기본으로 표시되며, 사이드바의 **'대시보드'** 메뉴를 클릭하여 언제든 돌아올 수 있습니다.

> **v0.2.0** — SSE 실시간 데이터 푸시 및 인프라 로드 최적화

대시보드의 모든 데이터는 **SSE(Server-Sent Events)**를 통해 실시간으로 갱신됩니다. 서버에서 상태가 변경될 때만 데이터가 실시간으로 Push되어 네트워크 오버헤드가 기존 폴링 방식 대비 **99% 감소**했습니다. 또한 리눅스 **cgroup v2**를 직접 읽어 프로세스 리소스를 측정함으로써 CPU 부하를 **79% 절감**하여 저사양 환경에서도 안정적으로 동작합니다.

<!-- 스크린샷: 대시보드 전체 화면 -->
![대시보드 전체 화면](assets/images/user/02_dashboard_overview.png)

---

## 상단 장애 알림 배너

대시보드 상단(헤더 바 내부)에는 장애 경보 배너가 위치합니다.

<!-- 스크린샷: 장애 경보 배너 -->
![장애 경보 배너](assets/images/user/02_dashboard_alert_banner.png)

| 상태 | 동작 |
|------|------|
| **장애 발생** | 빨간색 배너가 나타나며, 장애가 발생한 서비스명과 메시지가 표시됩니다. 배너를 클릭하면 해당 장애의 상세 리포트로 이동합니다. |
| **복구 완료** | 동일 서비스에 대해 복구 성공(`RECOVERY_SUCCESS`) 알림이 수신되면, 배너가 자동으로 숨겨집니다. |
| **정상** | 활성 장애가 없으면 배너가 표시되지 않습니다. |

!> **주의**: 배너가 사라지더라도 알림 버튼의 빨간 뱃지와 관리자 보고 목록의 미읽음 상태는 유지됩니다. 관리자가 직접 "읽음" 처리해야 뱃지가 사라집니다. 이는 장애 이력의 감사 추적성을 보장하기 위한 정책입니다.

---

## 알림 버튼 및 뱃지

헤더 우측의 종 모양 알림 버튼에는 미읽음 알림 개수를 표시하는 빨간색 뱃지가 표시됩니다.

1. 미읽음 알림이 있으면 뱃지에 숫자가 표시됩니다 (최대 `99+`).
2. 알림 버튼을 클릭하면 팝오버 형태의 알림 목록이 표시됩니다.
3. 목록에서 **'모두 읽음'** 버튼을 클릭하면 모든 알림이 읽음 처리되고 뱃지가 사라집니다.

<!-- 스크린샷: 알림 버튼 뱃지 및 팝오버 -->
![알림 버튼 뱃지](assets/images/user/02_dashboard_alert_badge.png)

알림 시스템은 **10초 주기**로 서버에 새로운 알림이 있는지 자동으로 확인합니다.

---

## 카드 섹션

대시보드는 여러 개의 정보 카드로 구성되어 있습니다. 각 카드의 역할을 상세히 설명합니다.

### 1. 라이선스 / 기관 정보

<!-- 스크린샷: 라이선스 기관 정보 카드 -->
![라이선스 기관 정보 카드](assets/images/user/02_dashboard_license_card.png)

TACHYON 솔루션의 라이선스 및 기관 정보를 표시합니다.

| 항목 | 설명 |
|------|------|
| **회사명** | 설치된 솔루션의 회사(기관)명 |
| **기관 코드** | 라이선스에 등록된 고유 기관 코드 |
| **에이전트 수** | 라이선스에서 허용된 에이전트 설치 가능 수량 |

이 정보는 TACHYON의 `app_info.properties_dev` 파일에서 자동으로 크롤링됩니다. 정보를 습득하지 못한 경우 `N/A`로 표시됩니다.

---

### 2. 시스템 가동 시간

<!-- 스크린샷: 시스템 가동 시간 카드 -->
![시스템 가동 시간 카드](assets/images/user/02_dashboard_uptime_card.png)

서버의 가동 시간(Uptime)을 표시합니다.

| 항목 | 설명 |
|------|------|
| **Uptime** | 서버가 마지막으로 부팅된 이후 경과한 시간 (예: `5d 12h 30m`) |
| **설정 요약** | 현재 적용 중인 솔루션 이름 (예: `TACHYON Admin`) |

?> **팁**: Uptime은 `/proc/uptime`을 직접 읽어 표시하며, 외부 명령어(`uptime`)에 의존하지 않습니다.

---

### 3. CPU 사용률

<!-- 스크린샷: CPU 사용률 카드 -->
![CPU 사용률 카드](assets/images/user/02_dashboard_cpu_card.png)

서버의 실시간 CPU 사용률을 프로그레스 바와 함께 표시합니다.

| 요소 | 설명 |
|------|------|
| **사용률 수치** | 현재 CPU 사용률 (%, 소수점 1자리) |
| **프로그레스 바** | 사용률에 따라 너비가 변하는 시각적 표시 |
| **색상 변화** | 정상(초록/파랑) -> 주의(노랑) -> 경고(빨강)으로 단계별 색상 전환 |

프로그레스 바는 부드러운 애니메이션(0.5초 전환)으로 갱신되어 시각적 안정감을 제공합니다.

---

### 4. 메모리 상태

<!-- 스크린샷: 메모리 상태 카드 -->
![메모리 상태 카드](assets/images/user/02_dashboard_memory_card.png)

서버의 메모리 사용 현황을 상세하게 표시합니다.

| 항목 | 설명 | 예시 |
|------|------|------|
| **사용량 / 전체** | 현재 사용 중인 메모리와 전체 메모리 | `12.5 / 32.0 GB (39%)` |
| **Free** | 여유(사용 가능) 메모리 | `19.5 GB` |
| **Total** | 전체 물리 메모리 | `32.0 GB` |
| **프로그레스 바** | 사용률에 따른 시각적 표시 | - |

---

### 5. 디스크 사용량

<!-- 스크린샷: 디스크 사용량 카드 -->
![디스크 사용량 카드](assets/images/user/02_dashboard_disk_card.png)

서버의 디스크 사용 현황을 루트 디스크와 제품 디렉토리별로 구분하여 표시합니다.

**상단 요약 영역:**

| 항목 | 설명 |
|------|------|
| **Root** | 루트(`/`) 파티션의 사용량 / 전체 / 사용률 (예: `45.2 GB / 100 GB (45.2%)`) |

**하위 디렉토리별 용량:**

TACHYON 설치 경로(`/usr/local/TACHYON/TTS40/`) 아래의 주요 디렉토리별 사용량이 목록으로 표시됩니다:

| 디렉토리 | 설명 |
|----------|------|
| **TACHYON** | 솔루션 메인 디렉토리 |
| **MariaDB** | 데이터베이스 데이터 디렉토리 |
| **OpenSearch** | 검색 엔진 데이터 디렉토리 |
| **Kafka** | 메시지 브로커 데이터 디렉토리 |
| **Redis** | 인메모리 캐시 데이터 디렉토리 |

각 항목은 **디렉토리 이름**, **전체 경로**(마우스 오버 시 툴팁), **사용 용량**이 표시됩니다.

?> **팁**: 디스크 사용량은 `unix.Statfs`와 `filepath.WalkDir`을 통해 직접 계산되며, `df`나 `du` 같은 외부 명령어에 의존하지 않습니다.

---

### 6. 서비스 리소스 상태 점검

<!-- 스크린샷: 서비스 리소스 상태 점검 테이블 -->
![서비스 리소스 상태 점검](assets/images/user/02_dashboard_service_table.png)

TACHYON 솔루션에 포함된 모든 서비스의 실시간 리소스 상태를 테이블 형태로 표시합니다.

#### 테이블 컬럼

| 컬럼 | 설명 |
|------|------|
| **SERVICE** | 서비스 유닛 이름 (예: `tachyon-shield`, `mariadb`, `nginx` 등) |
| **STATUS** | 서비스 활성 상태 (`Active` = 초록색 뱃지, `Exited` = 주황색 뱃지 + `?` 힌트, `Inactive` = 빨간색 뱃지 + `?` 힌트) |
| **PID** | 프로세스 ID (비활성 시 `-`) |
| **CPU(%)** | 해당 서비스의 CPU 사용률 |
| **MEMORY** | 해당 서비스의 메모리 사용량 (예: `256.4 MB`) |

#### 테이블 기능

1. **컬럼 정렬**: 각 컬럼 헤더를 클릭하면 오름차순/내림차순으로 정렬됩니다. 현재 정렬 상태는 화살표 아이콘으로 표시됩니다.
2. **컬럼 너비 조절**: 컬럼 경계를 드래그하여 너비를 자유롭게 조절할 수 있습니다.
3. **정렬 초기화**: 좌측 상단의 회전 화살표 버튼(`↺`)을 클릭하면 정렬이 기본 상태(이름 오름차순)로 초기화됩니다.
4. **수동 새로고침**: 우측 상단의 새로고침 버튼을 클릭하면 즉시 데이터를 갱신합니다.
5. **Total Services**: 테이블 우측 상단에 전체 서비스 수가 표시됩니다.

---

## 자동 갱신

대시보드의 데이터 갱신 방식은 다음과 같습니다:

| 항목 | 갱신 방식 | 비고 |
|------|----------|------|
| **대시보드 전체 데이터** | **SSE (실시간 Push)** | 변경 사항 발생 시 즉시 전송. 가장 효율적인 통신 방식. |
| **시스템 리소스(CPU/MEM)** | **SSE (실시간 Push)** | cgroup v2 직접 읽기로 초정밀 실시간 업데이트. |
| **알림 및 뱃지** | **10초 폴링** | 시스템 안정성을 위해 별도 주기로 동작. |

### 탭 비활성 시 동작

브라우저 탭이 백그라운드로 전환되면:

1. SSE 연결이 자동으로 **해제**됩니다 (서버 리소스 절약).
2. 모든 폴링 타이머가 **정지**됩니다.
3. 탭으로 복귀하면 SSE가 자동 **재연결**되고 즉시 최신 데이터를 수신합니다.

대시보드를 벗어나 다른 메뉴로 이동하면 SSE 연결 및 자동 갱신 타이머가 정리되어 불필요한 API 호출이 발생하지 않습니다.

---

## 조작 순서 요약

1. TACHYON 대시보드 또는 직접 URL을 통해 tkadmin에 접속합니다.
2. 대시보드가 기본 화면으로 자동 표시됩니다.
3. 상단 카드에서 라이선스, 시스템 가동 시간, CPU, 메모리, 디스크 상태를 확인합니다.
4. 하단 서비스 테이블에서 각 서비스의 상태와 리소스 사용량을 확인합니다.
5. 장애가 감지되면 상단 빨간색 배너와 알림 뱃지를 통해 즉시 인지할 수 있습니다.
6. 알림 버튼을 클릭하여 상세 알림 내역을 확인하고, 필요 시 '모두 읽음' 처리합니다.

---

## 다음 단계

- [내/외부 설정 편집기](02-config-editor.md): tkadmin의 주요 설정을 관리하는 방법을 확인하세요.
